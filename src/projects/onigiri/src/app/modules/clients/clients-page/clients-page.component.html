@let data = store.customers();

<div class="flex justify-content-between align-items-center o-page-title">
  <h1>Clients</h1>

  @if(!isLoading() && data.length) {
  <o-button (onClick)="onCreate()">Add Contact</o-button>
  }
</div>

<div class="o-mt-40">
  @if(isLoading()) {
  <p-skeleton
    width="100%"
    height="300px" />

  } @else if(data.length) {

  <p-table
    [value]="data"
    class="entities-table desktop-table">
    <ng-template pTemplate="header">
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>City</th>
        <th>Country</th>
        <th></th>
      </tr>
    </ng-template>

    <ng-template
      pTemplate="body"
      let-customer>
      <tr>
        <td>
          <span
            class="entity-name"
            (click)="onEdit(customer.id)">
            {{ customer.contactName || '(Not named)' }}
          </span>
        </td>
        <td>{{ customer.email }}</td>
        <td>{{ customer.phone }}</td>
        <td>{{ customer.city }}</td>
        <td>{{ customer.country }}</td>
        <td>
          <div class="entity-actions">
            <div class="entity-action">
              <o-icon
                key="trash"
                (click)="onDelete(customer.id)" />
            </div>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="mobile-cards">
    @for (customer of data; track customer.id) {
    <client-card
      [customer]="customer"
      [showActions]="true">
      <span
        actions
        class="client-card__dots"
        (click)="openMobileMenu(customer)"
        >â‹¯</span
      >
    </client-card>
    }
  </div>

  } @else {

  <empty-state-placeholder
    title="Create your first client"
    subTitle="Keep track on your clients. Save all the important information in one place."
    btnText="Create contact"
    (onCreateClick)="onCreate()">
    <ng-template oTemplate="sample">
      <div class="sample-img">
        <img
          src="../../../../assets/customer_sample.jpg"
          alt="Sample" />
      </div>
    </ng-template>
  </empty-state-placeholder>

  }
</div>

@if(selectedCustomer()) {
<div
  class="mobile-menu-overlay"
  (click)="closeMobileMenu()">
  <div
    class="mobile-menu"
    (click)="$event.stopPropagation()">
    <client-card
      [customer]="selectedCustomer()!"
      [showActions]="false"></client-card>

    <div class="mobile-menu__actions">
      <button
        class="mobile-menu__button mobile-menu__button--delete"
        (click)="onDeleteMobile()">
        <o-icon key="trash" />
        Delete
      </button>
      <button
        class="mobile-menu__button mobile-menu__button--edit"
        (click)="onEditMobile()">
        <o-icon key="edit" />
        Edit
      </button>
    </div>
  </div>
</div>
}
